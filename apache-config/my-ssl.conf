<VirtualHost *:443>

    ServerName birder.epita.fr
    DocumentRoot /usr/local/apache2/htdocs

    SSLEngine on
    SSLCertificateFile "/usr/local/apache2/conf/server.crt"
    SSLCertificateKeyFile "/usr/local/apache2/conf/server.key"


    #this is required by mod_auth_openidc
    #OIDCCryptoPassphrase a-random-secret-used-by-apache-oidc-and-balancer

    #OIDCProviderMetadataURL http:///soa_keycloak:8080/realms/apache-realm/.well-known/openid-configuration

    #OIDCClientID apache
    #OIDCClientSecret XaWywc5pSy4gXB1NxeXEpxPblcF1XV5p
    #OIDCRedirectURI http://localhost/private/redirect_uri

    # maps the preferred_username claim to the REMOTE_USER environment variable
    #OIDCRemoteUserClaim preferred_username

    
    # Public API
    <Location /public>
        ProxyPass http://soa_backend:4000/public
        ProxyPassReverse http://soa_backend:4000/public
        Require all granted
    </Location>

    # Private API
    <Location /private>
        ProxyPass http://soa_backend:4000/private
        ProxyPassReverse http://soa_backend:4000/private
        AuthType Basic
        AuthName "SOA PRIVATE API"
        AuthBasicProvider file
        AuthUserFile /usr/local/apache2/conf/.htpasswd
        Require valid-user
        #AuthType openid-connect
        #Require valid-user
    </Location>

    #<Location /keycloak>
       # ProxyPass http://soa_keycloak:8080/
      #  ProxyPassReverse http://soa_keycloak:8080/
      #  Require all granted
     #</Location>


</VirtualHost>